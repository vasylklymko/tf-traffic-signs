
# TensorFlow 2 Object Detection API tutorial

<https://tensorflow-object-detection-api-tutorial.readthedocs.io/en/latest/install.html>

#  The article about Tensorflow 2 Object Detection API installation

<https://neptune.ai/blog/how-to-train-your-own-object-detector-using-tensorflow-object-detection-api>

# This repository must be cloned to the main project folder

<https://github.com/tensorflow/models.git>

# Download and unzip pre-treined-model into ./workspace/training_demo/pre-trained-models

<http://download.tensorflow.org/models/object_detection/tf2/20200711/ssd_resnet50_v1_fpn_640x640_coco17_tpu-8.tar.gz>

# Useful references 

## Model parameters update and explanations

<https://towardsdatascience.com/3-steps-to-update-parameters-of-faster-r-cnn-ssd-models-in-tensorflow-object-detection-api-7eddb11273ed>

## Model Training process explanation

<https://becominghuman.ai/tensorflow-object-detection-api-tutorial-training-and-evaluating-custom-object-detector-ed2594afcf73>

# Model training results

| Date       | Model name                          | Dataset                 | Classes | Steps  | Changed parameters                                                                                                                                                                                                                                | Total lose                                                                                                                                                                                               | Training time |
|------------|-------------------------------------|-------------------------|---------|--------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
| 08.09.2023 | my_ssd_resnet50_v1_fpn_3(attempt 1) | new data ( 63 + 7 )     | 1       | 2000   | box_coder<br/> faster_rcnn_box_coder <br/>y_scale: 32.0 <br/> x_scale: 32.0 <br/> height_scale: 3.0<br/> width_scale: 3.0                                                                                                                         | Loss/classification_loss': 0.087042436,<br/> 'Loss/localization_loss': 0.1134364, <br/>'Loss/regularization_loss': 141.97772,<br/> 'Loss/total_loss': 142.17819,<br/> 'learning_rate': 0.02765367        |               |
| 08.09.2023 | my_ssd_resnet50_v1_fpn_3(attempt 2) | new data    ( 63 + 7 )  | 1       | 2000   | box_coder<br/> faster_rcnn_box_coder <br/>y_scale: 32.0 <br/> x_scale: 32.0 <br/> height_scale: 3.0<br/> width_scale: 3.0 <br/> feature_extractor <br/> regularizer  <br/> l2_regularizer <br/> weight: 0.0039999998989515007                     | Loss/classification_loss': 0.08048342,<br/> 'Loss/localization_loss': 0.08371392, <br/>  'Loss/regularization_loss': 1.8251712,<br/>  'Loss/total_loss': 1.9893686, <br/> 'learning_rate': 0.02765367    |               |
| 08.09.2023 | my_ssd_resnet50_v1_fpn_3(attempt 2) | new data  ( 63 + 7 )    | 1       | 5000   | box_coder<br/> faster_rcnn_box_coder <br/>y_scale: 32.0 <br/> x_scale: 32.0 <br/> height_scale: 3.0<br/> width_scale: 3.0 <br/> feature_extractor <br/> regularizer  <br/> l2_regularizer <br/> weight: 0.0039999998989515007                     | Loss/classification_loss': 0.04645691,<br/> 'Loss/localization_loss': 0.03727855,<br/> 'Loss/regularization_loss': 1.218591,<br/> 'Loss/total_loss': 1.3023264,<br/> 'learning_rate': 0.0                |               |
| 08.09.2023 | my_ssd_resnet50_v1_fpn_4            | merged( 1 173+ 367)     | 1       | 2000   | default settings                                                                                                                                                                                                                                  | Loss/classification_loss': 0.14104246,<br/> 'Loss/localization_loss': 0.036720034,<br/>'Loss/regularization_loss': 0.5548869,<br/> 'Loss/total_loss': 0.7326494,<br/> 'learning_rate': 0.02765367        |               | 
| 08.09.2023 | my_ssd_resnet50_v1_fpn_4            | merged( 1 173+ 367)     | 1       | 5000   | default settings                                                                                                                                                                                                                                  | Loss/classification_loss': 0.10410424,<br/> 'Loss/localization_loss': 0.002667,<br/>'Loss/regularization_loss': 0.434, <br/> 'Loss/total_loss': 0.5646,<br/> 'learning_rate': 0.002565                   |               |
| 08.09.2023 | my_ssd_resnet50_v1_fpn_5            | old(39 209 + 12 630)    | 43      | 2000   | default settings                                                                                                                                                                                                                                  | Loss/classification_loss': 0.39376923,<br/> 'Loss/localization_loss': 0.09792734,<br/> 'Loss/regularization_loss': 8.203386,<br/> 'Loss/total_loss': 8.695083,<br/> 'learning_rate': 0.02765367          |               |
| 08.09.2023 | my_ssd_resnet50_v1_fpn_5            | old(39 209 + 12 630)    | 43      | 5000   | default settings                                                                                                                                                                                                                                  | Loss/classification_loss': 0.37449005,<br/> 'Loss/localization_loss': 0.035043817,<br/> 'Loss/regularization_loss': 6.3507357,<br/> 'Loss/total_loss': 6.7602696,<br/> 'learning_rate': 0.0}             |               |
| 11.09.2023 | my_ssd_resnet50_v1_fpn_6            | merged( 1 173+ 367)     | 1       | 2000   | default settings                                                                                                                                                                                                                                  | Loss/classification_loss': 0.15419555,<br/> 'Loss/localization_loss': 0.07264473,<br/><br/>'Loss/regularization_loss': 0.90698236,<br/> 'Loss/total_loss': 1.1338227,<br/> 'learning_rate': 0.04}        |               |
| 11.09.2023 | my_ssd_resnet50_v1_fpn_6            | merged( 1 173+ 367)     | 1       | 5000   | default settings                                                                                                                                                                                                                                  | Loss/classification_loss': 0.083304584,<br/> 'Loss/localization_loss': 0.036396172,<br/> 'Loss/regularization_loss': 0.37474895,<br/> 'Loss/total_loss': 0.4944497,<br/>  'learning_rate': 0.038344227}  |               |
| 11.09.2023 | my_ssd_resnet50_v1_fpn_6            | merged( 1 173+ 367)     | 1       | 10000  | default settings                                                                                                                                                                                                                                  | Loss/classification_loss': 0.08339043,<br/> 'Loss/localization_loss': 0.028751556,<br/> 'Loss/regularization_loss': 0.113948725,<br/> 'Loss/total_loss': 0.2260907,<br/> 'learning_rate': 0.029201299}   |               |
| 11.09.2023 | my_ssd_resnet50_v1_fpn_6            | merged( 1 110+ 360)     | 1       | 25000  | default settings                                                                                                                                                                                                                                  | Loss/classification_loss': 0.050757114,<br/> 'Loss/localization_loss': 0.024710273,<br/> 'Loss/regularization_loss': 0.041128635,<br/> 'Loss/total_loss': 0.11659602,<br/>  'learning_rate': 0.0}        |               |
| 12.09.2023 | my_ssd_resnet50_v1_fpn_7            | new (63 + 7)            | 1       | 2000   | default settings  + fine tune (my_model_6)                                                                                                                                                                                                        | Loss/classification_loss': 0.18906675,<br/> 'Loss/localization_loss': 0.07325558,<br/> 'Loss/regularization_loss': 3.9281578,<br/> 'Loss/total_loss': 4.19048,<br/>  'learning_rate': 0.04               |               |   
| 12.09.2023 | my_ssd_resnet50_v1_fpn_7            | new (63 + 7)            | 1       | 5000   | default settings  + fine tune (my_model_6)                                                                                                                                                                                                        | Loss/classification_loss': 0.14375335,<br/> 'Loss/localization_loss': 0.022870917,<br/> 'Loss/regularization_loss': 1.5380881,<br/> 'Loss/total_loss': 1.7047123,<br/>  'learning_rate': 0.039907582     |               |
| 12.09.2023 | my_ssd_resnet50_v1_fpn_7            | new (63 + 7)            | 1       | 10000  | default settings  + fine tune (my_model_6)                                                                                                                                                                                                        | Loss/classification_loss': 0.08657152,<br/> 'Loss/localization_loss': 0.016304428,<br/> 'Loss/regularization_loss': 0.34765399,<br/> 'Loss/total_loss': 0.45052993,<br/> 'learning_rate': 0.039345898    |               |
| 12.09.2023 | my_ssd_resnet50_v1_fpn_7            | new (63 + 7)            | 1       | 20000  | default settings  + fine tune (my_model_6)                                                                                                                                                                                                        | Loss/classification_loss': 0.024699995,<br/> 'Loss/localization_loss': 0.0072968355,<br/> 'Loss/regularization_loss': 0.055525996,<br/> 'Loss/total_loss': 0.08752283,<br/>  'learning_rate': 0.03676176 |               |
| 13.09.2023 | my_ssd_resnet50_v1_fpn_7            | new (63 + 7)            |         | 100000 | default settings  + fine tune (my_model_6)                                                                                                                                                                                                        | Loss/classification_loss': 0.001332,<br/> 'Loss/localization_loss': 0.000051,<br/> 'Loss/regularization_loss': 0.01455,<br/> 'Loss/total_loss': 0.002838,<br/>  'learning_rate': 0.0                     |               |
| 13.09.2023 | my_ssd_resnet50_v1_fpn_8            | merged(39 262 + 12 637) | 43      | 2000   | default settings                                                                                                                                                                                                                                  | Loss/classification_loss': 0.11769141,<br/> 'Loss/localization_loss': 0.02517348,<br/> 'Loss/regularization_loss': 0.21927199,<br/> 'Loss/total_loss': 0.3621369,<br/> 'learning_rate': 0.04             |               |
| 13.09.2023 | my_ssd_resnet50_v1_fpn_8            | merged(39 262 + 12 637) | 43      | 5000   | default settings                                                                                                                                                                                                                                  | Loss/classification_loss': 0.19717331,<br/> 'Loss/localization_loss': 0.057666212,<br/> 'Loss/regularization_loss': 0.15873909,<br/> 'Loss/total_loss': 0.4135786,<br/> 'learning_rate': 0.036629394     |               |
| 13.09.2023 | my_ssd_resnet50_v1_fpn_8            | merged(39 262 + 12 637) | 43      | 10000  | default settings                                                                                                                                                                                                                                  | Loss/classification_loss': 0.27284652,<br/> 'Loss/localization_loss': 0.010584417,<br/> 'Loss/regularization_loss': 0.10114496,<br/> 'Loss/total_loss': 0.3845759,<br/> 'learning_rate': 0.019999998     |               |
| 13.09.2023 | my_ssd_resnet50_v1_fpn_8            | merged(39 262 + 12 637) | 43      | 18000  | default settings                                                                                                                                                                                                                                  | Loss/classification_loss': 0.21182477,<br/> 'Loss/localization_loss': 0.027235199,<br/> 'Loss/regularization_loss': 0.08787721,<br/> 'Loss/total_loss': 0.3269372,<br/>  'learning_rate': 0.0            |               |
| 14.09.2023 | my_ssd_resnet50_v1_fpn_9            | merged(39 262 + 12 637) | 43      | 100000 | default settings  + fine tune (my_model_8)                                                                                                                                                                                                        | Loss/classification_loss': 0.18595591,<br/> 'Loss/localization_loss': 0.028893244,<br/> 'Loss/regularization_loss': 0.04689191,<br/> 'Loss/total_loss': 0.26174107,<br/> 'learning_rate': 0.0            |               |
| 15.09.2023 | my_ssd_resnet50_v1_fpn_10           | merged(39 262 + 12 637) | 43      | 100000 | default settings  + fine tune (my_model_9)                                                                                                                                                                                                        | Loss/classification_loss': 0.2918705,<br/> 'Loss/localization_loss': 0.022263037,<br/> 'Loss/regularization_loss': 0.045995064,<br/> 'Loss/total_loss': 0.3601286,<br/> 'learning_rate': 0.0             |               |
| 17.09.2023 | my_ssd_resnet50_v1_fpn_12           | merged(39 262 + 12 637) | 43      | 40000  | image augmentation settings + fine tune (my_model_10)   learning canceled                                                                                                                                                                         |                                                                                                                                                                                                          |               |
| 17.09.2023 | my_ssd_resnet50_v1_fpn_13           | merged(39 262 + 12 637) | 43      | 200000 | image augmentation + fine tune (my_model_12)  + ExponentialDecayLearningRate { <br/> initial_learning_rate : 0.04 <br/> decay_steps : 200000 <br/> decay_factor : 0.95 <br/> min_learning_rate: 0,0001                                            | Loss/classification_loss': 0.283,<br/> 'Loss/localization_loss': 0.03129,<br/> 'Loss/regularization_loss': 0.1296,<br/> 'Loss/total_loss': 0.4635,<br/> 'learning_rate': 0.0004                          |               |
| 18.09.2023 | my_ssd_resnet50_v1_fpn_14           | merged(39 262 + 12 637) | 43      | 40000  | default settings  + fine tune (my_model_13)   + learning_rate {  <br/>   cosine_decay_learning_rate {  <br/>  learning_rate_base: 0.0001  <br/> total_steps: 40000 <br/>   warmup_learning_rate: 0.00005 <br/> warmup_steps: 2000 <br/>} <br/> }  | Loss/classification_loss': 0.50770324,<br/> 'Loss/localization_loss': 0.02281485,<br/> 'Loss/regularization_loss': 0.19125137,<br/> 'Loss/total_loss': 0.72176945,<br/> 'learning_rate': 0.0             |               |
| 20.09.2023 | my_ssd_resnet50_v1_fpn_15           | merged(39 262 + 12 637) | 43      | 100000 | default settings  + fine tune (my_model_14)   + learning_rate {  <br/>   cosine_decay_learning_rate {  <br/>  learning_rate_base: 0.0001  <br/> total_steps: 100000 <br/>   warmup_learning_rate: 0.00005 <br/> warmup_steps: 2000 <br/>} <br/> } | Loss/classification_loss': 0.27881858, <br/>'Loss/localization_loss': 0.009139867, <br/>'Loss/regularization_loss': 0.18682504, <br/>'Loss/total_loss': 0.47478348, <br/>'learning_rate': 0.0            |               |
| 21.09.2023 | my_ssd_resnet50_v1_fpn_16           | merged(39 262 + 12 637) | 43      | 100000 | default settings  + fine tune (my_model_15)   + learning_rate {  <br/>   cosine_decay_learning_rate {  <br/>  learning_rate_base: 0.0001  <br/> total_steps: 100000 <br/>   warmup_learning_rate: 0.00005 <br/> warmup_steps: 2000 <br/>} <br/> } | Loss/classification_loss': 0.2530932, <br/>'Loss/localization_loss': 0.02011345,<br/> 'Loss/regularization_loss': 0.18386897, <br/>'Loss/total_loss': 0.45707563,<br/> 'learning_rate': 0.0              |               |
| 22.09.2023 | my_ssd_resnet50_v1_fpn_17           | merged(39 262 + 12 637) | 43      | 100000 | fine tune (my_model_16) + learning_rate {  <br/> exponential_decay_learning_rate {  <br/> initial_learning_rate : 0.00025 <br/> decay_steps : 1000  <br/>  decay_factor : 0.99   <br/>  min_learning_rate: 0.00007   <br/> }}                     | Loss/classification_loss': 0.11379491, <br/> 'Loss/localization_loss': 0.0097759, <br/> 'Loss/regularization_loss': 0.16877525, <br/> 'Loss/total_loss': 0.29234606,  <br/>'learning_rate': 9.150817e-05 |               |
| 23.09.2023 | my_ssd_resnet50_v1_fpn_18           | merged(39 262 + 12 637) | 43      | 200000 | fine tune (my_model_17) + learning_rate {  <br/> exponential_decay_learning_rate {  <br/> initial_learning_rate : 0.00025 <br/> decay_steps : 1000  <br/>  decay_factor : 0.99   <br/>  min_learning_rate: 0.00007    <br/> }}                    | Loss/classification_loss': 0.05334, <br/> 'Loss/localization_loss': 0.00678, <br/> 'Loss/regularization_loss': 0.1529, <br/> 'Loss/total_loss': 0.2131,  <br/>'learning_rate': 7.e-05                    |               |                                                                                                                                                                                               |                                                                                                                                                                                                          |               |
| 24.09.2023 | my_ssd_resnet50_v1_fpn_19           | merged(39 262 + 12 637) | 43      | 200000 | fine tune (my_model_18) + learning_rate {  <br/> exponential_decay_learning_rate {  <br/> initial_learning_rate : 0.0001 <br/> decay_steps : 1000  <br/>  decay_factor : 0.99   <br/>  min_learning_rate: 0.00002  <br/>}}                        | Loss/classification_loss': 0.0508, <br/> 'Loss/localization_loss': 0.005553, <br/> 'Loss/regularization_loss': 0.1585, <br/> 'Loss/total_loss': 0.2148,  <br/>'learning_rate': 1.34e-5                   |               |
| 25.09.2023 | my_ssd_resnet50_v1_fpn_20(base)     | merged(39 262 + 12 637) | 43      | 200000 | fine tune (my_model_19) + learning_rate {  <br/> exponential_decay_learning_rate {  <br/> initial_learning_rate : 0.0001 <br/> decay_steps : 5000  <br/>  decay_factor : 0.99   <br/>  min_learning_rate: 0.00004  <br/> }}                       | Loss/classification_loss': 0.04098187, 'Loss/localization_loss': 0.004922797, 'Loss/regularization_loss': 0.14719191, 'Loss/total_loss': 0.19309658, 'learning_rate': 6.68972e-05                        |               | 
| 30.09.2023 | my_ssd_resnet50_v1_fpn_21           | new_set(2 143 + 259)    | 43      | 240000 | fine tune (my_model_20) + image augmentation + learning_rate {  <br/> exponential_decay_learning_rate {  <br/> initial_learning_rate : 0.0001 <br/> decay_steps : 5000  <br/>  decay_factor : 0.99   <br/>  min_learning_rate: 0.00004  <br/>}}   | Loss/classification_loss': 0.005705, 'Loss/localization_loss': 0.001734, 'Loss/regularization_loss': 0.144, 'Loss/total_loss': 0.2184, 'learning_rate': 6.17e-05                                         |               |
| 02.10.2023 | my_ssd_resnet50_v1_fpn_22           | new_set(2 143 + 259)    | 43      | 300000 | fine tune (my_model_21) + image augmentation + learning_rate {  <br/> exponential_decay_learning_rate {  <br/> initial_learning_rate : 0.0001 <br/> decay_steps : 5000  <br/>  decay_factor : 0.99   <br/>  min_learning_rate: 0.00001  <br/>}}   | Loss/classification_loss': 0.167, 'Loss/localization_loss': 0.07495, 'Loss/regularization_loss': 0.1366, 'Loss/total_loss': 0.3785, 'learning_rate': 5.47e-05                                            |               |